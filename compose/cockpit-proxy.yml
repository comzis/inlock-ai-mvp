# Cockpit Proxy - Bridges Docker network to host Cockpit
# This container runs on the edge network and proxies to host Cockpit
services:
  cockpit-proxy:
    image: alpine/socat:latest
    restart: always
    networks:
      - edge
    extra_hosts:
      - "host.docker.internal:host-gateway"
    command: ["tcp-listen:8080,fork,reuseaddr", "tcp-connect:host.docker.internal:9090"]
    healthcheck:
      test: ["CMD-SHELL", "nc -z host.docker.internal 9090"]
      interval: 30s
      timeout: 5s
      retries: 3
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

networks:
  edge:
    external: true
    name: edge

