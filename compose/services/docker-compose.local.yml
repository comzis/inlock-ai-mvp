version: '3.8'

# Local Development Web Stack
# Usage: docker compose -f docker-compose.local.yml up
# simplified for MacBook/Localhost execution

services:
  # Mock Inlock AI App
  inlock-ai:
    image: inlock-ai:latest
    build: .
    ports:
      - "3040:3040"
    environment:
      - NODE_ENV=development
    volumes:
      - .:/app
      - /app/node_modules

  # Local Database
  inlock-db:
    image: postgres:15-alpine
    ports:
      - "5432:5432"
    # SECURITY: Use environment variables instead of hardcoded password
    # Option 1: Create .env.local from .env.local.example and use: --env-file .env.local
    # Option 2: Set environment variables: POSTGRES_PASSWORD=your_password docker compose up
    # Option 3: Use defaults below (change dev_password to your secure password)
    environment:
      - POSTGRES_USER=${POSTGRES_USER:-postgres}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-dev_password_change_me}
      - POSTGRES_DB=${POSTGRES_DB:-inlock}
    volumes:
      - inlock_db_local:/var/lib/postgresql/data

  # Local Redis
  inlock-redis:
    image: redis:6-alpine
    ports:
      - "6379:6379"

volumes:
  inlock_db_local:
